{
  "version": 3,
  "sources": ["../../../../src/cli/lib/api.ts"],
  "sourcesContent": ["import chalk from \"chalk\";\nimport {\n  CONVEX_DEPLOY_KEY_ENV_VAR_NAME,\n  bigBrainAPI,\n  bigBrainAPIMaybeThrows,\n  getAuthHeaderFromGlobalConfig,\n  getConfiguredDeploymentOrCrash,\n  logAndHandleAxiosError,\n  readAdminKeyFromEnvVar,\n} from \"./utils.js\";\nimport { Context, logError, logFailure } from \"../../bundler/context.js\";\nimport {\n  deploymentNameFromAdminKeyOrCrash,\n  deploymentTypeFromAdminKey,\n  readDeploymentEnvVar,\n} from \"./deployment.js\";\nimport { buildEnvironment } from \"./envvars.js\";\nimport { checkAuthorization, performLogin } from \"./login.js\";\n\nexport type DeploymentName = string;\nexport type DeploymentType = \"dev\" | \"prod\";\n\nexport type Project = {\n  id: string;\n  name: string;\n  slug: string;\n  isDemo: boolean;\n};\n\ntype AdminKey = string;\n\n// Init\n// Provision a new empty project and return the new deployment credentials.\nexport async function createProjectProvisioningDevOrProd(\n  ctx: Context,\n  {\n    teamSlug: selectedTeamSlug,\n    projectName,\n  }: { teamSlug: string; projectName: string },\n  firstDeploymentType: DeploymentType\n): Promise<{\n  projectSlug: string;\n  teamSlug: string;\n  deploymentName: string;\n  url: string;\n  adminKey: AdminKey;\n  projectsRemaining: number;\n}> {\n  const provisioningArgs = {\n    team: selectedTeamSlug,\n    projectName,\n    deploymentType: firstDeploymentType,\n    backendVersionOverride: process.env.CONVEX_BACKEND_VERSION_OVERRIDE,\n  };\n  const data = await bigBrainAPI({\n    ctx,\n    method: \"POST\",\n    url: \"create_project\",\n    data: provisioningArgs,\n  });\n  const {\n    projectSlug,\n    teamSlug,\n    deploymentName,\n    adminKey,\n    projectsRemaining,\n    prodUrl: url,\n  } = data;\n  if (\n    projectSlug === undefined ||\n    teamSlug === undefined ||\n    deploymentName === undefined ||\n    url === undefined ||\n    adminKey === undefined ||\n    projectsRemaining === undefined\n  ) {\n    const error =\n      \"Unexpected response during provisioning: \" + JSON.stringify(data);\n    logError(ctx, chalk.red(error));\n    return await ctx.crash(1, \"transient\", error);\n  }\n  return {\n    projectSlug,\n    teamSlug,\n    deploymentName,\n    url,\n    adminKey,\n    projectsRemaining,\n  };\n}\n\n// Reinit\nexport async function fetchDeploymentCredentialsProvisioningDevOrProd(\n  ctx: Context,\n  { teamSlug, projectSlug }: { teamSlug: string; projectSlug: string },\n  deploymentType: DeploymentType\n): Promise<{\n  deploymentName: string | undefined;\n  url: string;\n  adminKey: AdminKey;\n}> {\n  try {\n    return fetchDeploymentCredentialsProvisioningDevOrProdMaybeThrows(\n      ctx,\n      { teamSlug, projectSlug },\n      deploymentType\n    );\n  } catch (error) {\n    return await logAndHandleAxiosError(ctx, error);\n  }\n}\n\n// Dev\nexport async function fetchDeploymentCredentialsForName(\n  ctx: Context,\n  deploymentName: DeploymentName,\n  deploymentType: DeploymentType\n) {\n  let data;\n  try {\n    data = await bigBrainAPIMaybeThrows({\n      ctx,\n      method: \"POST\",\n      url: \"deployment/authorize_for_name\",\n      data: {\n        deploymentName,\n        deploymentType,\n      },\n    });\n  } catch (error) {\n    return { error };\n  }\n  const adminKey = data.adminKey;\n  const url = data.url;\n  const resultDeploymentType = data.deploymentType;\n  if (adminKey === undefined || url === undefined) {\n    const msg = \"Unknown error during authorization: \" + JSON.stringify(data);\n    logError(ctx, chalk.red(msg));\n    return await ctx.crash(1, \"transient\", new Error(msg));\n  }\n  return {\n    deploymentName,\n    adminKey,\n    url,\n    deploymentType: resultDeploymentType,\n  };\n}\n\nexport type DeploymentSelection =\n  | { kind: \"prod\" }\n  | { kind: \"preview\"; previewName: string }\n  | { kind: \"deployment\"; deploymentName: string }\n  | { kind: \"ownDev\" }\n  | { kind: \"urlWithAdminKey\"; url: string; adminKey: string }\n  | { kind: \"urlWithLogin\"; url: string };\n\nexport function storeAdminKeyEnvVar(adminKeyOption?: string | null) {\n  if (adminKeyOption) {\n    // So we don't have to worry about passing through the admin key everywhere\n    // if it's explicitly overridden by a CLI option, override the env variable\n    // directly.\n    process.env[CONVEX_DEPLOY_KEY_ENV_VAR_NAME] = adminKeyOption;\n  }\n}\n\nexport type DeploymentSelectionOptions = {\n  prod?: boolean | undefined;\n  previewName?: string | undefined;\n  deploymentName?: string | undefined;\n  url?: string | undefined;\n  adminKey?: string | undefined;\n};\n\nexport function deploymentSelectionFromOptions(\n  options: DeploymentSelectionOptions\n): DeploymentSelection {\n  storeAdminKeyEnvVar(options.adminKey);\n  if (options.url !== undefined) {\n    const adminKey = readAdminKeyFromEnvVar();\n    if (adminKey) {\n      return { kind: \"urlWithAdminKey\", url: options.url, adminKey };\n    }\n    return { kind: \"urlWithLogin\", url: options.url };\n  }\n  if (options.prod) {\n    return { kind: \"prod\" };\n  }\n  if (options.previewName !== undefined) {\n    return { kind: \"preview\", previewName: options.previewName };\n  }\n  if (options.deploymentName !== undefined) {\n    return { kind: \"deployment\", deploymentName: options.deploymentName };\n  }\n  return { kind: \"ownDev\" };\n}\n\n// Deploy\nexport async function fetchDeploymentCredentialsWithinCurrentProject(\n  ctx: Context,\n  deploymentSelection: DeploymentSelection\n): Promise<{\n  url: string;\n  adminKey: AdminKey;\n  deploymentNames?: {\n    configured: string | null;\n    selected: string;\n  };\n  deploymentType?: string | undefined;\n}> {\n  if (deploymentSelection.kind === \"urlWithAdminKey\") {\n    return {\n      adminKey: deploymentSelection.adminKey,\n      url: deploymentSelection.url,\n    };\n  }\n\n  const configuredAdminKey = readAdminKeyFromEnvVar();\n\n  const configuredDeployment = readDeploymentEnvVar();\n\n  // Crash if we know that DEPLOY_KEY (adminKey) is required\n  if (configuredAdminKey === undefined) {\n    const buildEnvironmentExpectsConvexDeployKey = buildEnvironment();\n    if (buildEnvironmentExpectsConvexDeployKey) {\n      logFailure(\n        ctx,\n        `${buildEnvironmentExpectsConvexDeployKey} build environment detected but ${CONVEX_DEPLOY_KEY_ENV_VAR_NAME} is not set. ` +\n          `Set this environment variable to deploy from this environment. See https://docs.convex.dev/production/hosting`\n      );\n      await ctx.crash(1);\n    }\n    const header = await getAuthHeaderFromGlobalConfig(ctx);\n    if (!header) {\n      logFailure(\n        ctx,\n        `Error: You are not logged in. Log in with \\`npx convex dev\\` or set the ${CONVEX_DEPLOY_KEY_ENV_VAR_NAME} environment variable. ` +\n          `See https://docs.convex.dev/production/hosting`\n      );\n      await ctx.crash(1);\n    }\n  }\n\n  const data = await fetchDeploymentCredentialsWithinCurrentProjectInner(\n    ctx,\n    deploymentSelection,\n    configuredDeployment,\n    configuredAdminKey\n  );\n  const {\n    deploymentName: selectedDeploymentName,\n    adminKey,\n    deploymentType,\n    url,\n  } = data;\n  if (\n    adminKey === undefined ||\n    url === undefined ||\n    selectedDeploymentName === undefined\n  ) {\n    const msg = \"Unknown error during authorization: \" + JSON.stringify(data);\n    logError(ctx, chalk.red(msg));\n    return await ctx.crash(1, \"transient\", new Error(msg));\n  }\n  return {\n    deploymentNames: {\n      selected: selectedDeploymentName,\n      configured: configuredDeployment,\n    },\n    adminKey,\n    url,\n    deploymentType,\n  };\n}\n\ntype ProjectSelection =\n  | {\n      kind: \"deploymentName\";\n      // Identify a project by one of the deployments in it.\n      deploymentName: string;\n    }\n  | {\n      kind: \"teamAndProjectSlugs\";\n      // Identify a project by its team and slug.\n      teamSlug: string;\n      projectSlug: string;\n    };\n\nexport async function projectSelection(\n  ctx: Context,\n  configuredDeployment: string | null,\n  configuredAdminKey: string | undefined\n): Promise<ProjectSelection> {\n  if (\n    configuredAdminKey &&\n    deploymentTypeFromAdminKey(configuredAdminKey) === \"preview\"\n  ) {\n    const adminKeyParts = configuredAdminKey.split(\"|\")[0].split(\":\");\n    if (adminKeyParts.length !== 3) {\n      logFailure(ctx, \"Invalid CONVEX_DEPLOY_KEY for previews\");\n      return await ctx.crash(1);\n    }\n    const [_preview, teamSlug, projectSlug] = adminKeyParts;\n    return {\n      kind: \"teamAndProjectSlugs\",\n      teamSlug,\n      projectSlug,\n    };\n  }\n  if (\n    configuredAdminKey &&\n    deploymentTypeFromAdminKey(configuredAdminKey) === \"prod\"\n  ) {\n    return {\n      kind: \"deploymentName\",\n      deploymentName: await deploymentNameFromAdminKeyOrCrash(\n        ctx,\n        configuredAdminKey\n      ),\n    };\n  }\n  if (configuredDeployment) {\n    return {\n      kind: \"deploymentName\",\n      deploymentName: configuredDeployment,\n    };\n  }\n  logFailure(\n    ctx,\n    \"Select project by setting `CONVEX_DEPLOYMENT` with `npx convex dev` or `CONVEX_DEPLOY_KEY` from the Convex dashboard.\"\n  );\n  return await ctx.crash(1);\n}\n\nasync function fetchDeploymentCredentialsWithinCurrentProjectInner(\n  ctx: Context,\n  deploymentSelection: DeploymentSelection,\n  configuredDeployment: string | null,\n  configuredAdminKey: string | undefined\n): Promise<{\n  deploymentName?: string;\n  adminKey?: string;\n  url?: string;\n  deploymentType?: string;\n}> {\n  switch (deploymentSelection.kind) {\n    case \"ownDev\": {\n      if (configuredDeployment === null) {\n        logFailure(\n          ctx,\n          \"No CONVEX_DEPLOYMENT set, run `npx convex dev` to configure a Convex project\"\n        );\n        return await ctx.crash(1);\n      }\n      return {\n        ...(await fetchExistingDevDeploymentCredentialsOrCrash(\n          ctx,\n          configuredDeployment\n        )),\n        deploymentName: configuredDeployment,\n      };\n    }\n    case \"prod\":\n      if (configuredDeployment === null) {\n        logFailure(\n          ctx,\n          \"No CONVEX_DEPLOYMENT set, run `npx convex dev` to configure a Convex project\"\n        );\n        return await ctx.crash(1);\n      }\n      if (configuredAdminKey) {\n        // Derive as much as we can from the configured admin key,\n        // to avoid unnecessary API calls.\n        const deploymentType = deploymentTypeFromAdminKey(configuredAdminKey);\n        if (deploymentType !== \"prod\") {\n          logFailure(\n            ctx,\n            `Please set ${CONVEX_DEPLOY_KEY_ENV_VAR_NAME} to a new key which you can find on the Convex dashboard for your production deployment.`\n          );\n          await ctx.crash(1);\n        }\n        let url;\n        if (process.env.CONVEX_PROVISION_HOST) {\n          const data = await bigBrainAPI({\n            ctx,\n            method: \"POST\",\n            url: \"deployment/authorize_prod\",\n            data: {\n              deploymentName: configuredDeployment,\n            },\n          });\n          url = data.url;\n        } else {\n          // When using prod big-brain, we can derive the backend url directly\n          // from the deployment name.\n          url = await deriveUrlFromAdminKey(ctx, configuredAdminKey);\n        }\n        return {\n          adminKey: configuredAdminKey,\n          url,\n          deploymentName: configuredDeployment,\n          deploymentType,\n        };\n      }\n      return await bigBrainAPI({\n        ctx,\n        method: \"POST\",\n        url: \"deployment/authorize_prod\",\n        data: {\n          deploymentName: configuredDeployment,\n        },\n      });\n    case \"preview\":\n      return await bigBrainAPI({\n        ctx,\n        method: \"POST\",\n        url: \"deployment/authorize_preview\",\n        data: {\n          previewName: deploymentSelection.previewName,\n          projectSelection: await projectSelection(\n            ctx,\n            configuredDeployment,\n            configuredAdminKey\n          ),\n        },\n      });\n    case \"deployment\":\n      return await bigBrainAPI({\n        ctx,\n        method: \"POST\",\n        url: \"deployment/authorize_within_current_project\",\n        data: {\n          selectedDeploymentName: deploymentSelection.deploymentName,\n          projectSelection: await projectSelection(\n            ctx,\n            configuredDeployment,\n            configuredAdminKey\n          ),\n        },\n      });\n    case \"urlWithLogin\":\n      return {\n        ...(await bigBrainAPI({\n          ctx,\n          method: \"POST\",\n          url: \"deployment/authorize_within_current_project\",\n          data: {\n            selectedDeploymentName: configuredDeployment,\n            projectSelection: await projectSelection(\n              ctx,\n              configuredDeployment,\n              configuredAdminKey\n            ),\n          },\n        })),\n        url: deploymentSelection.url,\n      };\n    case \"urlWithAdminKey\":\n      return {\n        adminKey: deploymentSelection.adminKey,\n        url: deploymentSelection.url,\n      };\n    default: {\n      const _exhaustivenessCheck: never = deploymentSelection;\n      return ctx.crash(1);\n    }\n  }\n}\n\n// Run, Import\nexport async function fetchDeploymentCredentialsProvisionProd(\n  ctx: Context,\n  deploymentSelection: DeploymentSelection\n): Promise<{\n  url: string;\n  adminKey: AdminKey;\n  deploymentName?: string;\n  deploymentType?: string;\n}> {\n  if (\n    deploymentSelection.kind === \"ownDev\" &&\n    !(await checkAuthorization(ctx, false))\n  ) {\n    await performLogin(ctx);\n  }\n\n  if (deploymentSelection.kind !== \"ownDev\") {\n    const result = await fetchDeploymentCredentialsWithinCurrentProject(\n      ctx,\n      deploymentSelection\n    );\n    return {\n      url: result.url,\n      adminKey: result.adminKey,\n      deploymentName: result.deploymentNames?.selected,\n      deploymentType: result.deploymentType,\n    };\n  }\n\n  const configuredDeployment = await getConfiguredDeploymentOrCrash(ctx);\n  const result = await fetchExistingDevDeploymentCredentialsOrCrash(\n    ctx,\n    configuredDeployment\n  );\n  return {\n    url: result.url,\n    adminKey: result.adminKey,\n    deploymentType: result.deploymentType,\n    deploymentName: configuredDeployment,\n  };\n}\n\n// Dashboard\nexport async function fetchTeamAndProject(\n  ctx: Context,\n  deploymentName: string\n) {\n  const data = (await bigBrainAPI({\n    ctx,\n    method: \"GET\",\n    url: `deployment/${deploymentName}/team_and_project`,\n  })) as {\n    team: string; // slug\n    project: string; // slug\n    teamId: number;\n    projectId: number;\n  };\n\n  const { team, project } = data;\n  if (team === undefined || project === undefined) {\n    const msg =\n      \"Unknown error when fetching team and project: \" + JSON.stringify(data);\n    logFailure(ctx, msg);\n    return await ctx.crash(1, \"transient\", new Error(msg));\n  }\n\n  return data;\n}\n\n// Used by dev for upgrade from team and project in convex.json to CONVEX_DEPLOYMENT\nexport async function fetchDeploymentCredentialsProvisioningDevOrProdMaybeThrows(\n  ctx: Context,\n  { teamSlug, projectSlug }: { teamSlug: string; projectSlug: string },\n  deploymentType: DeploymentType\n): Promise<{\n  deploymentName: string | undefined;\n  url: string;\n  adminKey: AdminKey;\n}> {\n  const data = await await bigBrainAPIMaybeThrows({\n    ctx,\n    method: \"POST\",\n    url: \"deployment/provision_and_authorize\",\n    data: {\n      teamSlug,\n      projectSlug,\n      deploymentType,\n    },\n  });\n  const deploymentName = data.deploymentName;\n  const adminKey = data.adminKey;\n  const url = data.url;\n  if (adminKey === undefined || url === undefined) {\n    const msg = \"Unknown error during authorization: \" + JSON.stringify(data);\n    logError(ctx, chalk.red(msg));\n    return await ctx.crash(1, \"transient\", new Error(msg));\n  }\n  return { adminKey, url, deploymentName };\n}\n\nasync function fetchExistingDevDeploymentCredentialsOrCrash(\n  ctx: Context,\n  deploymentName: DeploymentName\n): Promise<{\n  url: string;\n  adminKey: AdminKey;\n  deploymentType: \"dev\";\n}> {\n  const credentials = await fetchDeploymentCredentialsForName(\n    ctx,\n    deploymentName,\n    \"dev\"\n  );\n  if (\"error\" in credentials) {\n    logFailure(\n      ctx,\n      `Failed to authorize \"${deploymentName}\" configured in CONVEX_DEPLOYMENT, run \\`npx convex dev\\` to configure a Convex project`\n    );\n    return await ctx.crash(1, \"invalid filesystem data\", credentials.error);\n  }\n  if (credentials.deploymentType !== \"dev\") {\n    logFailure(ctx, `Deployment \"${deploymentName}\" is not a dev deployment`);\n    return await ctx.crash(1, \"invalid filesystem data\", credentials.error);\n  }\n  return credentials;\n}\n\n// This returns the the url of the deployment from an admin key in the format\n//      \"tall-forest-1234|1a2b35123541\"\n//   or \"prod:tall-forest-1234|1a2b35123541\"\nasync function deriveUrlFromAdminKey(ctx: Context, adminKey: string) {\n  const deploymentName = await deploymentNameFromAdminKeyOrCrash(ctx, adminKey);\n  return `https://${deploymentName}.convex.cloud`;\n}\n"],
  "mappings": "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",
  "names": ["chalk", "result"]
}
